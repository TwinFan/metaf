<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Metaf example: parse METAR or TAF and convert to JSON</title>
    <style type="text/css">
    body { background-color:lightblue; color:black; text-align:center;}
    </style>
    <script>
      function convertToJson() {
        var inputStr = document.getElementById("input").value;
        var result = Module.ccall('toJson',     // name of C function 
                                  'string',     // return type
                                  ['string'],   // argument types
                                  [inputStr]);  // arguments
        Module.ccall('freeMemory', null, null, null);
        if (document.getElementById("formattedResult").checked) {
          resultObj = JSON.parse(result);
          const spacing = 2;
          result = JSON.stringify(resultObj, null, spacing);
        }
        document.getElementById("result").value = result;
      };
    </script>
    {{{ SCRIPT }}}
  </head>
  <body>
    <h1>Convert METAR & TAF to JSON</h1>
  		Enter METAR or TAF here:<br>
      <textarea id="input" rows="8" cols="80" onInput="convertToJson()"></textarea><br>
      <br><br>
  		Conversion result:<br>
      <textarea id="result" rows="8" cols="80" readonly></textarea><br>
      <input type="checkbox" id="formattedResult" onclick="convertToJson()">Formatted result<br>
  </body>
</html>